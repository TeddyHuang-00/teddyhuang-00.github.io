---
import type { CollectionEntry } from "astro:content";
import { Icon } from "astro-icon/components";
import { SITE } from "@/config";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";

export interface Props {
  hideEditPost?: CollectionEntry<"blog">["data"]["hideEditPost"];
  class?: string;
  post: CollectionEntry<"blog">;
}

const { hideEditPost, post, class: className = "" } = Astro.props;

const locale = getLangFromUrl(Astro.url);
const localeString = useTranslations(locale);

const href = `${SITE.editPost.url}${post.filePath}`;
const showEditPost =
  SITE.editPost.enabled && !hideEditPost && href.trim() !== "";
---

{
  showEditPost && (
    <a
      href={href}
      target="_blank"
      rel="noopener noreferrer"
      class:list={[
        "flex justify-baseline gap-1.5 opacity-80 hover:text-accent",
        className,
      ]}
    >
      <Icon name="tabler:edit" class="inline-block size-6" />
      <span>{localeString("edit.this-page")}</span>
    </a>
  )
}
